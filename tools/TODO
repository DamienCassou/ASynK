-*- Outline -*- 

Created	    	: Tue Jul 12 18:45:48  2011
Last Modified	: Thu Aug 25 18:37:58  2011

* TODO

** Bugs

*** Many key changes related to Gmail -> OL are missing

    Thu Aug 25 18:04:31  2011

    All the confusion related to the return of the TechM laptop has
    appeared to have resulted in some 'bit rot' after all.

    I just noticed today that the version on github is missing 2 key
    pieces of the sync puzzle -> sync new gmail contacts to Outlook
    and also sync modified gmail contacts to Outlook. These changes
    are nowhere to be found - definitely not on the Transend. It was a
    lot of code changeand as I remember it, was even working quite
    well... It's a severe setback.

    Approach now is to continue making the fixes to other parts of the
    code base, and hope either the MacBook or the Scorpio will have
    it, and in good shape. That is the hope.

*** ol.prep_contact_lists() only works on startup

If we invoke this routine once, do some operation and then invoke it
again, we only get zero stats. This potentially exists for the gc
version as well.

*** need to store both the self link and edit link

Both of these are needed for different activities. This needs to be
done once we are pretty sure about the changes and we can take a
branch out to experiment this.

** Two Way Sync Logic

*** Alogrithm to query and track updates to Google API

Figure out how updates to the Google contact list can be
recognized and synched.

There is an api and query for contacts after a certain time. we can
specify the following parameters 

group: to limit entries
updated-min:timestamp
showdeleted:true

*** Algorithm to query and track updates to Outlook API

 0. Have a sync status json file with last sync start, last sync end
    and some basic stats related to sync.

 1. make list of all contacts locally, and create following
    overlapping lists:

    a. full list of entries along with their gc_ids if they exist
    b. entries modified after last sync: new entries: have no gc_id
    c. entries modified after last sync: old entries: have gc_id

 2. make list of all contacts on google contacts with following
    groups:
	updated since last sync

** Support more contact fields to be uploaded

   More contact fields need to get synched, including: 

   - All phon fields: Done
   - Fax
   - Anniversary
   - DOB
   - IM
   - URL

The postal address information is not getting uploaded
properly. There is no problem in reading it from the Outlook
addressbook. There is some problem in uploading it with the right
schema

** Distribution

We can make this an browser based application or an Outlook app. The
distribution might be smaller if we make it an Addin. However if we
make it a browser based application we might be able to reuse the code
for Karma.

*** Outlook Addin

**** Figure out how to add dialogs to the Outlook 

*** Browser App

**** Design

**** How to make it non-blocking

** Support more than one message store

We need to iterate and grab all the message store contents

There could be more than one message store in the default Outlook
Profile. Need to be able to look into all of them for contact
items.

* Done

** Track contacts that are uploaded

Completed: Tue Jul 12 18:43:20  2011

Store the ID of the newly created entry and store it in some user
defined field in Outlook.

** Refactor to make contacts.py more object oriented

The code is a mess overall. Should really have MapiMsgStore,
MapiFolder, Message etc. type wrapper objects. It is not a pretty
sight at the moment

** The outlook time stamp is in UTC

When comparind timestamps, the outlook last modified time we get is in
UTC, but without a timezone notifier. We need to get the time zones
normalized before comparison.

Fixed in ol_wrapper.py:prep_lists

** Sync "Other" phone details

number marked as Other is not getting synched to google.

* scratch

  - for each contact in outlook with gc_id:
  
    -- present -is he on gmail?
    -- if not present 

       --- if google says fellow has been deleted:
       	   -- delete from outlook
       --- else:
       	   -- should not really happen, but we could create a new
       	   -- contact on google and reset the gc_id in outlook

    -- else (contact present):

       --- if neither updated since last sync: we are done w/this chap

       --- if only updtate on outlook side since last sync, sync
           across to google

       --- if only update on gmail side since last sync, sync across
           to outlook

       --- if both sides have been updated since last sync:

           --- resolve direction based on config parameter
           --- sync accordingly

  - for each contact in gmail created since last sync:
    -- copy them to outlook


  - might require some local store of all outlook coctact entryids to
    be able to figure out deletes in outlook to be reflected properly
    in gmail. this we will keep for later.
